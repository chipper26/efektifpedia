<!doctype html>
<html lang="id">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <title>Blog - efektifpedia</title>
    <style>
      body { background-color: #f4f7f6; padding-top: 80px; }
      .card-blog { border: none; transition: 0.3s; background: none; border-bottom: 1px solid #dee2e6; border-radius: 0; margin-bottom: 20px; padding-bottom: 20px; }
      .card-blog img { width: 100%; height: 180px; object-fit: cover; border-radius: 8px; }
      .category-badge { background: #e9ecef; color: #0d6efd; padding: 4px 12px; border-radius: 4px; font-size: 0.75rem; text-transform: uppercase; font-weight: bold; margin-bottom: 10px; display: inline-block; }
      .blog-title { font-weight: 700; color: #212529; text-decoration: none; font-size: 1.25rem; line-height: 1.3; }
      .blog-title:hover { color: #0d6efd; }
      .meta-info { font-size: 0.85rem; color: #6c757d; margin-top: 10px; }
      
      /* Sidebar Style */
      .sidebar-title { font-weight: bold; text-transform: uppercase; border-bottom: 2px solid #0d6efd; padding-bottom: 5px; margin-bottom: 15px; font-size: 0.9rem; }
      .popular-item { list-style: none; padding: 0; }
      .popular-item li { padding: 10px 0; border-bottom: 1px solid #eee; display: flex; align-items: flex-start; }
      .popular-item li::before { content: "‚óè"; color: #0d6efd; margin-right: 10px; }
      .popular-link { text-decoration: none; color: #333; font-weight: 500; font-size: 0.95rem; line-height: 1.4; }
      .popular-link:hover { color: #0d6efd; }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top shadow-sm">
      <div class="container">
        <a class="navbar-brand" href="./">efektifpedia</a>
        <div class="navbar-nav ms-auto">
          <a class="nav-link" href="./">HOME</a>
          <a class="nav-link active" href="blog.html">BLOG</a>
        </div>
      </div>
    </nav>

    <div class="container mt-4">
      <div class="row">
        <div class="col-lg-8">
          <h5 class="sidebar-title">POSTINGAN TERBARU</h5>
          <div id="blog-container">
            <div class="text-center p-5">
              <div class="spinner-border text-primary"></div>
              <p>Memuat artikel...</p>
            </div>
          </div>
        </div>

        <div class="col-lg-4 mt-5 mt-lg-0">
          <div class="sticky-top" style="top: 90px;">
            <h5 class="sidebar-title">ARTIKEL TERPOPULER</h5>
            <ul class="popular-item" id="popular-container">
              </ul>
          </div>
        </div>
      </div>
    </div>

    <footer class="bg-primary text-white text-center py-3 mt-5">
      <p class="m-0">created by üî∂ irawan</p>
    </footer>

    <script>
      async function fetchPosts() {
        const repo = "chipper26/efektifpedia";
        const folder = "blog";
        const container = document.getElementById('blog-container');
        const popularContainer = document.getElementById('popular-container');

        try {
          const response = await fetch(`https://api.github.com/repos/${repo}/contents/${folder}`);
          const files = await response.json();
          
          // Filter hanya file .md dan urutkan dari yang terbaru
          const posts = files.filter(f => f.name.endsWith('.md')).reverse();
          
          container.innerHTML = '';
          popularContainer.innerHTML = '';

          posts.forEach((file, index) => {
            // Logic Judul dari Nama File
            const titleClean = file.name.replace(/^\d{4}-\d{2}-\d{2}-/, '').replace('.md', '').replace(/-/g, ' ');
            const postUrl = `post.html?file=${file.name}`;

            // 1. Render Kolom Utama (Posting Terbaru)
            container.innerHTML += `
              <div class="card card-blog">
                <div class="row align-items-center">
                  <div class="col-md-4 mb-3 mb-md-0">
                    <img src="https://via.placeholder.com/300x200?text=Efektifpedia" alt="cover">
                  </div>
                  <div class="col-md-8">
                    <span class="category-badge">Edukasi</span>
                    <a href="${postUrl}" class="blog-title">${titleClean}</a>
                    <div class="meta-info">
                      Oleh Tim Efektifpedia ‚Äî Januari 2026
                    </div>
                  </div>
                </div>
              </div>
            `;

            // 2. Render Sidebar (Top 5 Terpopuler/Terbaru)
            if(index < 6) {
              popularContainer.innerHTML += `
                <li><a href="${postUrl}" class="popular-link">${titleClean}</a></li>
              `;
            }
          });

        } catch (e) {
          container.innerHTML = "<p>Gagal memuat artikel.</p>";
        }
      }
      fetchPosts();
    </script>
  </body>
</html>